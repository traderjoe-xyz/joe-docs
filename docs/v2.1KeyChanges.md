---
sidebar_position: 4
sidebar_label: V2.1 Key Changes
---

# `Dex v2.1` Key Changes

This section highlights the key changes introduced in `Dex v2.1`. The changes will be described per contract.


### LBFactory

In this contract the changes are mainly linked to Preset updates:
- The `uint256 sampleLifetime` is being removed from the `PresetSet` event.
- The `getPreset()` function now return an additional variable `bool isOpen` that track if the change of Preset is open or not. The `sampleLifetime` variable is being removed.
- Whenever the state of the open state of the preset is updated a new `PresetOpenStateChanged` is being emmited.
- Additionally the `MAX_FEE()`, `MIN_BIN_STEP()`, `MAX_BIN_STEP()` and `MAX_PROTOCOL_SHARE()` are removed.
- New functions are implemeted: `getMinBinStep()`, `getFeeRecipient()`, `getMaxFlashLoanFee()`, `getFlashLoanFee()` and `getLBPairImplementation()`.

### LBPair 

The main changes in this contract are the output variables type:
- Event `StaticFeeParametersSet` now at a pair level.
- Events `DepositedToBins`, `WithdrawnFromBins`, `CompositionFees`, `CollectedProtocolFees`, `Swap` and `FlashLoan` now emit encoded `bytes32` amounts that can be decoded using the provided functions (decode examples in the Guides section).
- Functions `swap()`, `flashLoan()`, `mint()`, `burn()`, and `collectProtocolFees()` now returns encoded `bytes32` amounts.
- The `getReservesAndId` function is depricated and replaced by 2 new functions: `getReserves()` and `getActiveId()`.
- New functions being introduced: `getNextNonEmptyBin()`, `getProtocolFees()`, `getStaticFeeParameters()` and `getVariableFeeParameters()`

### LBRouter 

The LBRouter now support quotes from `JoeV1`, v2 Legacy `LB Pairs` and v2.1 `LB Pairs`.
- `enum Version` is tracking the version of a pair.
- New `Path` struct that represent the tokens path to go through to complete a swap (keep track of `versions` of the `DEX` and the `pairBinSteps` associated to the pair if applicable).
- A new `refundTo` address is being added to the `LiquidityParameters` struct.
- `AVAX` keywords in the swaps, add and remove liquidity functions changed to `NATIVE`:
    - i.e. swapExactTokensForAVAX() now is `swapExactTokensForNATIVE()`.
- The swaps, add and remove liquidity functions use now the new `Path` struct as input (examples in the Guides section).

### LBToken

Update on the transfers functions:
- Functions `safeTransferFrom()` and `safeBatchTransferFrom()` are removed.
- Replaced by `batchTransferFrom()` function.

### LBQuoter

The new LBQuoter now support quotes from all the Joe pairs/pools:
- Functions `findBestPathFromAmountOut()` and `findBestPathFromAmountIn()` get the best path over `JoeV1` pools, `v2` and `v2.1` pairs.
